(function(e,t){typeof define=="function"&&define.amd?define(["YouTubeAudit"],t):e.YouTubeAudit=t(e.b)})(this,function(e){var t=function(e){var t=this;e=e||{};this.iframeIds=e.ids||this.getYoutubePlayers();if(!this.iframeIds||this.iframeIds===[]){console.warn("No YouTube player detected, please check the documentation at https://github.com/obsidianart/youtube-statistics");return!1}this.players=e.players;this.storage=e.storage;window.onYouTubePlayerAPIReady=function(){var e;t.players=t.players||[];for(var n=0;n<t.iframeIds.length;n++){e=new YT.Player(t.iframeIds[n],{events:{onStateChange:function(){return function(){t.userActed.apply(t,Array.prototype.slice.call(arguments))}}()}});t.players.push(e)}}};t.prototype={userActed:function(e){var t={};if(e.data===YT.PlayerState.PLAYING)t.userAction="play";else{if(e.data!==YT.PlayerState.PAUSED)return!1;t.userAction="paused"}t.timecode=e.target.getCurrentTime();t.videoId=e.target.getVideoData().video_id;this.storage.save(t)},getYoutubePlayers:function(){var e=document.getElementsByTagName("iframe"),t=[];if(!e.length)return null;for(var n=0;n<e.length;n++)/^https?:\/\/(?:www\.)?youtube(?:-nocookie)?\.com(\/|$)/i.test(e[n].src)&&e[n].id&&t.push(e[n].id);return t}};var n=function(e){this.url=e.url;this.userId=e.userId};n.prototype={save:function(e){console.group("User "+e.userAction);console.log("User id : "+this.userId);console.log("video id : "+e.videoId);console.log("timecode :"+e.timecode);console.groupEnd()}};(function(){var e=document.createElement("script");e.src="http://www.youtube.com/player_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();var r=function(e){var r=new t({storage:new n({url:e.url||"http://www.myserver.com",userId:e.userId||"anonymous"})})};return r});